---
- block:
    - name: Asignar Red VM {{ vmostype }} - {{ vmname }} en VirtuaBox.
      shell: |
          {% if 'Tarjeta_puente_internet' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 bridged --bridgeadapter1 enp0s31f6
          {% elif 'Tarjeta_aislada_sin_internete' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 hostonly --hostonlyadapter1 vboxnet0
          {% elif 'Tarjeta_nat_internet_aislada' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 natnetwork --natnetwork1 vboxnat0
          {% elif 'Tarjetas_puente_aislada' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 bridged --bridgeadapter1 enp0s31f6
            VBoxManage modifyvm {{ vmname }} --nic2 hostonly --hostonlyadapter1 vboxnet0
          {% elif 'Tarjetas_aislada_puente' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 hostonly --hostonlyadapter1 vboxnet0
            VBoxManage modifyvm {{ vmname }} --nic2 bridged --bridgeadapter1 enp0s31f6
          {% elif 'Tarjetas_nat_aislada' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 natnetwork --natnetwork1 vboxnat0
            VBoxManage modifyvm {{ vmname }} --nic2 hostonly --hostonlyadapter1 vboxnet0
          {% elif 'Tarjetas_aislada_nat' in vmnets %}
            VBoxManage modifyvm {{ vmname }} --nic1 hostonly --hostonlyadapter1 vboxnet0
            VBoxManage modifyvm {{ vmname }} --nic2 natnetwork --natnetwork1 vboxnat0
          {% endif %}
  
- block:
    - name: Validar Red VM {{ vmostype }} - {{ vmname }} en VirtuaBox.
      shell: |
          {% if 'Tarjeta_puente_internet' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjeta_aislada_sin_internete' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjeta_nat_internet_aislada' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjetas_puente_aislada' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/1/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjetas_aislada_puente' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/1/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjetas_nat_aislada' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/1/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% elif 'Tarjetas_aislada_nat' in vmnets %}
            sleep 15
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/0/V4/IP 2>/dev/null | sed 's/Value: //g'
            VBoxManage guestproperty get {{ vmname }} /VirtualBox/GuestInfo/Net/1/V4/IP 2>/dev/null | sed 's/Value: //g'
          {% endif %}
      register: vmnets
